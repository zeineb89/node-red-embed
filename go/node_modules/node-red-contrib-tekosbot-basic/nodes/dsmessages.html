<!-- ***************** RPC MAKE *********************** -->
<script type="text/x-red" data-template-name="Deepstream RPC make">
    	
    <div class="form-row">
        <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Method</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream RPC make">
    <p>Connects to a server using the deepstream protocol to call a function with or without params for results.</p>
	<p>The function parameters will be stored in the <code>msg.payload</code></p>
    <p>If the message received is JSON <code>msg.payload</code> will be parsed into an object. If not it will be the raw data.</p>
    <p><code>msg.topic</code> is set to the predefined subscription topic.</p>
</script>

<script type="text/javascript">
   //  RED.nodes.registerType('Deepstream RPC make',{
   //      category: 'function',
   //      color:"#81DAF5",
   //      defaults: {
   //          name: {value:""},
   //          method: {
			// 	value:"",
			// 	required:true
			// }
   //      },
   //      inputs:1,
   //      outputs:1,
   //      icon: "chatbot-waiting.png",
   //      label: function() {
   //          return this.name || "Deepstream RPC Make";
   //      },
   //      labelStyle: function() {
   //          return (this.name)?"node_label_italic":"";
   //      }
   //  });
</script>

<!-- ***************** RPC PROVIDE *********************** -->
<script type="text/x-red" data-template-name="Deepstream RPC provide">
	
    <div class="form-row">
        <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Method</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream RPC provide">
    <p>Connects to a server using the deepstream protocol to provide a result for a method.</p>
	<p>The parameter <code>method</code> (or <code>msg.topic</code>) will define the method to which we answer.</p>
	<br>
	<p>The output will be put in :</p>
	<p>	<code>msg.payload</code> the function parameters</p>
	<p>	<code>msg.res</code> the response to which we will return the result</p>
</script>

<script type="text/javascript">
    // RED.nodes.registerType('Deepstream RPC provide',{
    //     category: 'input',
    //     color:"#81DAF5",
    //     defaults: {
    //         name: {value:""},
    //         method: {value:"",required:true}
    //     },
    //     inputs:0,
    //     outputs:1,
    //     icon: "chatbot-waiting.png",
    //     label: function() {
    //         return this.name||"Deepstream RPC";
    //     },
    //     labelStyle: function() {
    //         return (this.name)?"node_label_italic":"";
    //     }
    // });
</script>

<!-- ***************** RPC RESPONSE *********************** -->
<script type="text/x-red" data-template-name="Deepstream RPC response">	
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream RPC response">
	<p> Send response to deepstream </p>
	<p> If msg.err is not empty, it sends an error response with the content of msg.err. Otherwise it will send the msg.payload as data.
</script>

<script type="text/javascript">
  //   RED.nodes.registerType('Deepstream RPC response',{
  //       category: 'output',
  //       color:"#81DAF5",
  //       defaults: {
  //           name: {value:""}
  //       },
  //       inputs:1,
  //       outputs:0,
		// align: 'right',
  //       icon: "chatbot-waiting.png",
  //       label: function() {
  //           return this.name||"Deepstream RPC";
  //       },
  //       labelStyle: function() {
  //           return (this.name)?"node_label_italic":"";
  //       }
  //   });
</script>

<!-- ***************** Event emit *********************** -->
<script type="text/x-red" data-template-name="Deepstream Event emit">
    	
    <div class="form-row">
        <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Method</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream Event emit">
    <p>Connects to a server using the deepstream protocol to emit an event with or without params.</p>
	<p>The function parameters will be stored in the <code>msg.payload</code></p>   
</script>

<script type="text/javascript">
  //   RED.nodes.registerType('Deepstream Event emit',{
  //       category: 'output',
  //       color:"#81DAF5",
  //       defaults: {
  //           name: {value:""},
  //           method: {
		// 		value:""
		// 	}
  //       },
		// align: 'right',
  //       inputs:1,
  //       outputs:0,
  //       icon: "chatbot-waiting.png",
  //       label: function() {
  //           return this.name||"Deepstream Event";
  //       },
  //       labelStyle: function() {
  //           return (this.name)?"node_label_italic":"";
  //       }
  //   });
</script>

<!-- ***************** Event subscribe *********************** -->
<script type="text/x-red" data-template-name="Deepstream Event subscribe">
    
    <div class="form-row">
        <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Event</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream Event subscribe">
    <p>Connects to a server using the deepstream protocol to subscribe to an event.</p>
    <p>The parameter <code>Event</code> (or <code>msg.topic</code>) will define the event to which we subscribe.</p>
    <br>
    <p>The output will be put in <code>msg.payload</code></p>
</script>

<script type="text/javascript">
    // RED.nodes.registerType('Deepstream Event subscribe',{
    //     category: 'input',
    //     color:"#81DAF5",
    //     defaults: {
    //         name: {value:""},
    //         method: {value:"",required:true}
    //     },
    //     inputs:0,
    //     outputs:1,
    //     icon: "chatbot-waiting.png",
    //     label: function() {
    //         return this.name||"Deepstream Event";
    //     },
    //     labelStyle: function() {
    //         return (this.name)?"node_label_italic":"";
    //     }
    // });
</script>

<!-- ***************** DS Message receive *********************** -->
<script type="text/x-red" data-template-name="DS Message receive">
   
    <!-- <div class="form-row">
        <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Event</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div> -->

    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row" style="margin-left: -20px; margin-top: +20px">
      <div class="palette-header" style="width: 100%; margin-bottom: 20px"> <i class="fa fa-angle-down expanded"></i><span>Advanced settings</span> 
      </div>
    </div>
    <div class="form-row">
       <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Event</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <p style="font-size: 10px">Read the docs to learn more.</p>
    <p style="font-size: 10px">Otherwise, leave the default values.</p>

</script>

<script type="text/x-red" data-help-name="DS Message receive">
    <p>Hanna In node</p>
    <p>This configuration node connects to the WebSocket chat client.</p>
    <br>
    <p>The output will be put in <code>msg.payload</code></p>
</script>

<script type="text/javascript">
    
    RED.nodes.registerType('DS Message receive',{
        category: 'Channels',
        color:"#82ccdd",
        defaults: {
            name: {value: ""},
            msApp: {type:"hanna-app"},
            method: {value:"chat/message",required:true}
        },
        inputs:0,
        outputs:1,
        icon: "chatbot-waiting.png",
        align: 'left',
        paletteLabel: 'Hanna In',
        label: function() {
            // return (this.name ? this.name : this.appName);
            return this.name||"Hanna In";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
   
</script>

<!-- ***************** DS Message Router *********************** -->
<script type="text/x-red" data-template-name="DS Message Router">
     
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="DS Message Router">
    <p>Connects to a server using the deepstream protocol to subscribe to an event.</p>
    <p>The parameter <code>Event</code> will define the event to which we subscribe.</p>
    <br>
    <p>The output will be put in <code>msg.payload</code></p>
</script>

<script type="text/javascript">
    // RED.nodes.registerType('DS Message Router',{
    //     category: 'Hanna App',
    //     color:"#81DAF5",
    //     defaults: {
    //         name: {value:""}
    //     },
    //     inputs:0,
    //     outputs:1,
    //     icon: "chatbot-waiting.png",
    //     paletteLabel: 'Hanna Router',
    //     label: function() {
    //         return this.name||"Router";
    //     },
    //     labelStyle: function() {
    //         return (this.name)?"node_label_italic":"";
    //     }
    // });
</script>

<!-- ***************** DS Message Listener *********************** -->
<script type="text/x-red" data-template-name="DS Message listener">
    	
    <div class="form-row">
        <label for="node-input-method" style="width: 110px;"><i class="fa fa-envelope"></i>Event</label>
        <input type="text" id="node-input-method" placeholder="method">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="DS Message listener">
    <p>Connects to a server using the deepstream protocol to subscribe to an event.</p>
	<p>The parameter <code>Event</code> will define the event to which we subscribe.</p>
	<br>
    <p>Listener for user messages</p>
	<p>The output will be put in <code>msg.payload</code></p>
</script>

<script type="text/javascript">
    // RED.nodes.registerType('DS Message listener',{
    //     category: 'Hanna App',
    //     color:"#81DAF5",
    //     defaults: {
    //         name: {value:""},
    //         method: {value:"",required:true}
    //     },
    //     inputs:0,
    //     outputs:1,
    //     icon: "chatbot-waiting.png",
    //     label: function() {
    //         return this.name||"Listener";
    //     },
    //     labelStyle: function() {
    //         return (this.name)?"node_label_italic":"";
    //     }
    // });
</script>

<!-- ***************** Record update *********************** -->
<script type="text/x-red" data-template-name="Deepstream Record update">
    	    
	<div class="form-row">
        <label for="node-input-recordPath" style="width: 110px;"><i class="fa fa-envelope"></i>Record path</label>
        <input type="text" id="node-input-recordPath" placeholder="recordPath">
    </div>
	<div class="form-row">
        <label for="node-input-path" style="width: 110px;"><i class="fa fa-envelope"></i>Update path</label>
        <input type="text" id="node-input-path" placeholder="path">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream Record update">
    <p>Connects to a server using the deepstream protocol update a Record</p>
	<p>Retrieve the record with record Path<code>recordPath</code></p>  
	<br/>
	<p>If the <code>path</code> value is defined it updated the specified path of the record,  otherwise it replace all data</p>   
</script>

<script type="text/javascript">
  //   RED.nodes.registerType('Deepstream Record update',{
  //       category: 'output',
  //       color:"#81DAF5",
  //       defaults: {
  //           name: {value:""},
		// 	recordPath: {value:"", required:true},
		// 	path: {value:""}
  //       },
  //       inputs:1,
  //       outputs:0,
  //       icon: "chatbot-waiting.png",
		// align: 'right',
  //       label: function() {
  //           return this.name||"Deepstream Record";
  //       },
  //       labelStyle: function() {
  //           return (this.name)?"node_label_italic":"";
  //       }
  //   });
</script>




<!-- ***************** Message send *********************** -->
<script type="text/x-red" data-template-name="DS Message send">
          
   <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>
    <div class="form-row">
        <label for="node-input-nextListener" style="width: 110px;"><i class="fa fa-envelope"></i>Next listener</label>
        <input type="text" id="node-input-nextListener" placeholder="next listener">
    </div>
   
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="DS Message send">
    <p>Hanna out node</p>
    <p>This configuration node connects to WebSocket chat client.</p>
    <p>Retrieve the record with record Path<code>msg.record_path</code> or message will be determined by <code>msg.uid</code></p>  
</script>

<script type="text/javascript">
    RED.nodes.registerType('DS Message send',{
        category: 'Channels',
        color:"#82ccdd",
        defaults: {
            msApp: {type:"hanna-app"},
            name: {value:""},
            nextListener: {},
            nextUri: {value:""},
            nextAppName: {value:""}
        },
        inputs:1,
        outputs:0,
        icon: "chatbot-waiting.png",
        align: 'left',
        paletteLabel: 'Hanna Out',
        label: function() {
            return this.name||"Hanna out";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>



<!-- ***************** Message send *********************** -->
<script type="text/x-red" data-template-name="DS Action Trigger">
          
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>
    <div class="form-row">
        <label for="node-input-action" style="width: 110px;"><i class="fa fa-envelope"></i>Action</label>
        <select id="node-input-action" placeholder="Select action">
        <option value="send_sms">Send sms</option>
        <option value="phone_contacts">Phone contacts</option>
        <option value="lunch_map">Lunch map</option>
        <option value="upload_img">Upload image</option>
        <option value="upload_imgs">Upload images</option>
        <option value="login_fb">Login facebook</option>
        <option value="fb_photos">Facebook photos</option>
        <option value="clear_msgs">Clear Messages</option>
        <option value="disable_input">Disable Msg Input</option>
        <option value="favorite_apps">Favorite Apps</option>
        <option value="manage_apps">Manage Apps</option>
      </select>
    </div>
    <div class="form-row">
        <label for="node-input-emitTo" style="width: 110px;"><i class="fa fa-envelope"></i>Emit To</label>
        <input type="text" id="node-input-emitTo" placeholder="Emit To">
    </div>
  
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="DS Action Trigger">
    <p>Connects to a server using the deepstream protocol update a Record</p>
    <p>Retrieve data from action name <code>config.action</code> and intercept the message at <code>config.emitTo</code></p>  
    <br/>
    <p>uses <code>msg.params</code> to send params </p>
    <br>
    <p><b>Available actions</b></p>
    <p><code>phone_contacts</code> : get all phone contacts</p>
    <p><code>lunch_map</code> : lunch google maps <code>params.location</code></p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('DS Action Trigger',{
        category: 'Action',
        color:"#82ccdd",
        defaults: {
            name: {value:""},
            action: {value: "", required: true},
            emitTo: {value:""},
            msApp: {type:"hanna-app"}
        },
        inputs:1,
        outputs:1,
        icon: "chatbot-waiting.png",
        align: 'left',
        label: function() {
            return this.name||"Action Trigger";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>


<!-- ***************** Message authentication *********************** -->
<script type="text/x-red" data-template-name="Authentication">
    
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>          
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Authentication">
    <p>Present a login / signup / reset password widget into the Hanna Chatbot</p>
    <p>Send user info after login or signup </p>
    <p>Doesn't need configuration , just plug it into hanna-in channel , whenever you like your user to authenticate.</p>
</script>

<script type="text/javascript">
    RED.nodes.registerType('Authentication',{
        category: 'Action',
        color:"#38ada9",
        defaults: {
            name: {value:"Authentication"},
            msApp: {type:"hanna-app"}
        },
        inputs:1,
        outputs:1,
        icon: "chatbot-waiting.png",
        align: 'left',
        label: function() {
            return this.name||"Authentication";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Message stripe pay *********************** -->
<script type="text/x-red" data-template-name="stripe-pay">
    
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>    
          
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div> 
          
    <div class="form-row">
        <label for="node-input-public_key" style="width: 110px;"><i class="fa fa-key"></i>Public Key</label>
        <input type="text" id="node-input-public_key" placeholder="Public Key">
    </div> 
    

    <div class="form-row">
        <label for="node-input-email" style="width: 110px;"><i class="fa fa-tag"></i>Email</label>
        <input type="text" id="node-input-email" placeholder="Email">
    </div> 

    <div class="form-row">
        <label for="node-input-image" style="width: 110px;"><i class="fa fa-tag"></i>Image</label>
        <input type="text" id="node-input-image" placeholder="Image Url">
    </div> 
          
    <div class="form-row">
        <label for="node-input-btn_name" style="width: 110px;"><i class="fa fa-tag"></i>Button</label>
        <input type="text" id="node-input-btn_name" placeholder="Button Name (eg: subscribe , pay)">
    </div> 
          
    <div class="form-row">
        <label for="node-input-description" style="width: 110px;"><i class="fa fa-tag"></i>Description</label>
        <textarea id="node-input-description" placeholder="Description"></textarea>
    </div> 

    <div class="form-row">
        <label for="node-input-amount" style="width: 110px;"><i class="fa fa-tag"></i>Amount</label>
        <input type="text" id="node-input-amount" placeholder="Amount">
    </div>

    <div class="form-row">
        <label for="node-input-currency" style="width: 110px;"><i class="fa fa-tag"></i>Currency</label>
        <input type="text" id="node-input-currency" placeholder="Currency (eg: EUR,USD..)">
    </div>
</script>

<script type="text/x-red" data-help-name="stripe-pay">
    <p>Present a stripe widget into the Hanna Chatbot</p>
    <p>With this node you can add customer card , or make a payment </p>
    <p>The returned value in <code>msg.payload</code> contains the token generated after the action , it's up to you to call stripe method with your secret key to perform actions</p>
    <p>
      <pre>
          if you want to use dynamic variables you can use 
        <code>
            msg.params = {
                "publishable-key": public_key,
                image: image,
                name: btn_name,
                description: description,
                locale: locale,
                email: email,
                amount: amount,
                currency: currency
            }
        </code>
      </pre>
    </p>

</script>

<script type="text/javascript">
    RED.nodes.registerType('stripe-pay',{
        category: 'Payment',
        color:"#38ada9",
        defaults: {
            name: {value:"Stripe Pay"},
            msApp: {type:"hanna-app"},
            btn_name: {value:"Pay",required: true},
            public_key: {value:"",required: true},
            image: {value:""},
            description: {value:""},
            locale: {value:"auto"},
            email: {value:"",required: true},
            amount: {value:""},
            currency: {value:""}

        },
        paletteLabel: 'Stripe Pay',
        inputs:1,
        outputs:1,
        icon: "chatbot-waiting.png",
        align: 'left',
        label: function() {
            return this.name||"Stripe Pay";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Redirect actions results *********************** -->
<script type="text/x-red" data-template-name="Redirect Action">
    
    <div class="form-row">
        <label for="node-input-redirect" style="width: 110px;"><i class="fa fa-bookmark"></i>Redirect</label>
        <input type="text" id="node-input-redirect" placeholder="chat/loggedin">
    </div>          
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Redirect Action">
    <p>This should be set after an Action Node, Redirects the result to the origin app used, gets app from <code>msg.payload.app.uri</code> and <code>msg.payload.app.name</code> , the target application should use the listener used in this config "Redirect" to get the emitted event.

</script>

<script type="text/javascript">
    RED.nodes.registerType('Redirect Action',{
        category: 'Action',
        color:"#38ada9",
        defaults: {
            name: {value:"Redirect"},
            redirect: {value:"", required: true}
        },
        inputs:1,
        outputs:0,
        icon: "chatbot-waiting.png",
        align: 'left',
        label: function() {
            return this.name||"=> "+this.redirect;
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Message manage apps *********************** -->
<script type="text/x-red" data-template-name="Manage Apps">
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>   
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Manage Apps">
    <p>Present a Manage apps widget into the Hanna Chatbot</p>
    
   <!--  <p>Doesn't need configuration , just plug it into hanna-in channel , whenever you like your user to authenticate.</p> -->
</script>

<script type="text/javascript">
    RED.nodes.registerType('Manage Apps',{
        category: 'Action',
        color:"#38ada9",
        defaults: {
            name: {value:"Manage Apps"},
            msApp: {type:"hanna-app"}
        },
        inputs:1,
        outputs:1,
        icon: "chatbot-waiting.png",
        align: 'left',
        label: function() {
            return this.name||"Manage Apps";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Message clear msgs *********************** -->
<script type="text/x-red" data-template-name="Clear Messages">
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>   
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Clear Messages">
    <p>Clear the screen from previous messages</p>
    
   <!--  <p>Doesn't need configuration , just plug it into hanna-in channel , whenever you like your user to authenticate.</p> -->
</script>

<script type="text/javascript">
    RED.nodes.registerType('Clear Messages',{
        category: 'Action',
        color:"#d6f8b8",
        defaults: {
            name: {value:"Clear Messages"},
            msApp: {type:"hanna-app"}
        },
        inputs:1,
        outputs:1,
        icon: "clear-message.png",
        align: 'left',
        label: function() {
            return this.name||"Clear Messages";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Message disable_input *********************** -->
<script type="text/x-red" data-template-name="Disable Msg Input">
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>   
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Disable Msg Input">
    <p>Disable message input , used when you want to prevent your users from typing a text message</p>
    
   <!--  <p>Doesn't need configuration , just plug it into hanna-in channel , whenever you like your user to authenticate.</p> -->
</script>

<script type="text/javascript">
    RED.nodes.registerType('Disable Msg Input',{
        category: 'Action',
        color:"#d6f8b8",
        defaults: {
            name: {value:"Disable Msg Input"},
            msApp: {type:"hanna-app"}
        },
        inputs:1,
        outputs:0,
        icon: "clear-message.png",
        align: 'left',
        label: function() {
            return this.name||"Disable Msg Input";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Message upload imgs *********************** -->
<script type="text/x-red" data-template-name="Upload Images">
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>   
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Upload Images">
    <p>Present a Upload Images widget into the Hanna Chatbot</p>
    
   <!--  <p>Doesn't need configuration , just plug it into hanna-in channel , whenever you like your user to authenticate.</p> -->
</script>

<script type="text/javascript">
    RED.nodes.registerType('Upload Images',{
        category: 'Dialogue',
        color:"#ffebbb",
        defaults: {
            name: {value:"Bulk image upload"},
            msApp: {type:"hanna-app"}
        },
        inputs:1,
        outputs:1,
        icon: "chatbot-upload.png",
        align: 'left',
        label: function() {
            return this.name||"Upload Images";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** Message upload img *********************** -->
<script type="text/x-red" data-template-name="Upload Image">
    <div class="form-row">
        <label for="node-input-msApp" style="width: 110px;"><i class="fa fa-bookmark"></i>Application</label>
        <input type="text" id="node-input-msApp">
    </div>         
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Upload Image">
    <p>Present a Upload Image widget into the Hanna Chatbot</p>
    
   <!--  <p>Doesn't need configuration , just plug it into hanna-in channel , whenever you like your user to authenticate.</p> -->
</script>

<script type="text/javascript">
    RED.nodes.registerType('Upload Image',{
        category: 'Dialogue',
        color:"#ffebbb",
        defaults: {
            name: {value:"Upload Image"},
            msApp: {type:"hanna-app"}

        },
        inputs:1,
        outputs:1,
        icon: "chatbot-upload.png",
        align: 'left',
        label: function() {
            return this.name||"Upload Image";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
    });
</script>

<!-- ***************** App switcher *********************** -->
<script type="text/x-red" data-template-name="DS App switcher">
          
   
    <div class="form-row">
        <label for="node-input-uri" style="width: 110px;"><i class="fa fa-envelope"></i>App Uri</label>
        <input type="text" id="node-input-uri" placeholder="App uri">
    </div>
    <div class="form-row">
        <label for="node-input-appName" style="width: 110px;"><i class="fa fa-envelope"></i>App Name</label>
        <input type="text" id="node-input-appName" placeholder="App appName">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="DS App switcher">
    <p>Connects to a server using the deepstream protocol update config record and returnMsg</p>
    <p>Uses <code>msg.uid</code> to determine user messages record and update chat.config</p>  
    <br/>
    <p>If <code>msg.app_uri</code> and <code>msg.app_name</code> are empty, value is defined by config <code>appName</code> and <code>uri</code></p>   
</script>

<script type="text/javascript">
    // RED.nodes.registerType('DS App switcher',{
    //     category: 'Action',
    //     color:"#81DAF5",
    //     defaults: {
    //         name: {value:""},
    //         appName: {value:""},
    //         uri: {value:""}
    //     },
    //     inputs:1,
    //     outputs:0,
    //     icon: "chatbot-waiting.png",
    //     align: 'right',
    //     label: function() {
    //         return this.name||"App switcher";
    //     },
    //     labelStyle: function() {
    //         return (this.name)?"node_label_italic":"";
    //     }
    // });
</script>


<!-- ***************** Record subscribe *********************** -->
<script type="text/x-red" data-template-name="Deepstream Record subscribe">
	
    <div class="form-row">
        <label for="node-input-recordPath" style="width: 110px;"><i class="fa fa-envelope"></i>Record path</label>
        <input type="text" id="node-input-recordPath" placeholder="recordPath">
    </div>
  	<div class="form-row">
          <label for="node-input-path" style="width: 110px;"><i class="fa fa-envelope"></i>Subscribe path</label>
          <input type="text" id="node-input-path" placeholder="path">
      </div>
      <div class="form-row">
          <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
          <input type="text" id="node-input-name" placeholder="Name">
      </div>
</script>

<script type="text/x-red" data-help-name="Deepstream Record subscribe">
    <p>Connects to a server using the deepstream protocol to get a record and subscribe to the <code>Subscribe Path</code> if one is defined.</p>
	<p>The parameter <code>Record path</code> will define the record to get.</p>
	<br>
	<p> On subscription we retrieve the record, the msg will contain the following data : </p>
	<p> <code>msg.topic</code> : 'record'</p>
	<p> <code>msg.payload</code>: the record data</p>
	<br/>
	<p> Then on each update we will send the the following message : </p>
	<p> <code>msg.topic</code> : 'update'</p>
	<p> <code>msg.payload</code>: the updated data</p>
</script>

<script type="text/javascript">
   //  RED.nodes.registerType('Deepstream Record subscribe',{
   //      category: 'input',
   //      color:"#81DAF5",
   //      defaults: {
   //          name: {value:""},
   //          recordPath: {value:""},
			// path: {value:""}
   //      },
   //      inputs: 1,
   //      outputs:1,
   //      icon: "chatbot-waiting.png",
   //      label: function() {
   //          return this.name||"Deepstream Record";
   //      },
   //      labelStyle: function() {
   //          return (this.name)?"node_label_italic":"";
   //      }
   //  });
</script>

<!-- ***************** Record Get *********************** -->
<script type="text/x-red" data-template-name="Deepstream Record get">
	
    <div class="form-row">
        <label for="node-input-recordPath" style="width: 110px;"><i class="fa fa-envelope"></i>Record path</label>
        <input type="text" id="node-input-recordPath" placeholder="recordPath">
    </div>
    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>

<script type="text/x-red" data-help-name="Deepstream Record get">
    <p>Connects to a server using the deepstream protocol to get a record</p>
	<p>The parameter <code>Record path</code> will define the record to get.</p>
	<br>
	<p> The msg will contain the following data : </p>
	<p> <code>msg.payload</code>: the record data</p>
</script>

<script type="text/javascript">
    // RED.nodes.registerType('Deepstream Record get',{
    //     category: 'input',
    //     color:"#81DAF5",
    //     defaults: {
    //         name: {value:""},
    //         recordPath: {value:"",required:true}
    //     },
    //     inputs:1,
    //     outputs:1,
    //     icon: "chatbot-waiting.png",
    //     label: function() {
    //         return this.name||"Deepstream Record Get";
    //     },
    //     labelStyle: function() {
    //         return (this.name)?"node_label_italic":"";
    //     }
    // });
</script>

<!-- ***************** DS APP CONFIG *********************** -->
<script type="text/x-red" data-template-name="hanna-app">
    <div class="form-row" style="margin-left: -20px; margin-top: -20px">
    <div class="palette-header" style="width: 100%; margin-bottom: 20spx"><i class="fa fa-angle-down expanded"></i><span>node properties</span> </div>
    </div>
    <div class="form-row node-input-msApp">
        <label for="node-config-input-appName" style="width: 110px;"><i class="fa fa-envelope"></i>App Name</label>
        <input readonly="true" type="text" id="node-config-input-appName" placeholder="appName">
    </div>
    <div class="form-row node-input-msApp">
        <input type="hidden" id="node-config-input-uri">
    </div>
    <div class="form-row">
        <label for="node-config-input-link" style="width: 110px;"><i class="fa fa-tag"></i>Your App Link</label>
        <a id="node-config-input-link" target="_blanck" href="https://box.tekos.co/">https://box.tekos.co/@</a>
    </div>
    <div class="form-row">
        <label for="node-config-input-image" style="width: 110px;"><i class="fa fa-tag"></i>Logo URL</label>
        <input type="text" id="node-config-input-image" placeholder="logo url">
    </div>
    <div class="form-row">
        <label for="node-config-input-startMessage" style="width: 110px;"><i class="fa fa-tag"></i>Start Message</label>
        <textarea id="node-config-input-startMessage" style="width: 70%;" placeholder="start message (ex: start)" />
    </div>
    <div class="form-row">
        <label for="node-config-input-name" style="width: 110px;"><i class="fa fa-tag"></i>Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
  
    <!-- <hr style="height: 1px;/* margin: -0.5em 0; */color: #090606;border: 0;background-color: #333;"/>
    <div>Advanced Settings</div> -->
    <div class="form-row" style="margin-left: -20px; margin-top: +20px">
    <div class="palette-header" style="width: 100%; margin-bottom: 20px"><i class="fa fa-angle-down expanded"></i><span>Advanced settings</span> </div>
    </div>
    <div class="form-row">
        <label for="node-config-input-socket" style="width: 110px;"><i class="fa fa-tag"></i>Listener</label>
        <input type="text" id="node-config-input-socket" placeholder="Listener (ex: chat/message)">
    </div>
    <p style="font-size: 10px">Read the docs to learn more.</p>
    <p style="font-size: 10px">Otherwise, leave the default values.</p>
    
</script>
<script type="text/javascript">

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'}
      );var f=d.getElementsByTagName(s)[0],
      j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
      'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
      })(window,document,'script','dataLayer','GTM-MNDB6PK');

    
    setTimeout(function() {
      $.ajax({url: '/appParams', 
        async: true,
        method: 'GET',
        success: (res) => {
          $('body').append(`
            <a href="https://box.tekos.co/@${res.app_uri}.${res.app_name}/app" target="_blank" style="    position: fixed;
              bottom: 10px;
              right: 10px;
              padding: 15px;
              background: #d1d6e6;
              border: 1px solid #b3a5bb;
              border-radius: 5px;
              z-index: 99999;
              text-decoration: none;
              font-weight: bold;
              font-size: 18px;
              color: #6c11dd;">

            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px"
            width="35" height="35"
            viewBox="0 0 224 224"
            style=" fill:#000000;"><g fill="none" fill-rule="nonzero" stroke="none" stroke-width="1" stroke-linecap="butt" stroke-linejoin="miter" stroke-miterlimit="10" stroke-dasharray="" stroke-dashoffset="0" font-family="none" font-weight="none" font-size="none" text-anchor="none" style="mix-blend-mode: normal"><path d="M0,224v-224h224v224z" fill="none"></path><g fill="#6c11dd"><g id="surface1"><path d="M112,18.235c-56.595,0 -102.725,39.655 -102.725,89.285c0,28.805 15.785,53.8825 40.0225,70.28c-0.035,0.9625 0.035,2.52 -1.225,7.21c-1.575,5.7925 -4.7425,13.965 -11.165,23.17l-4.5675,6.545h7.98c27.65,0 43.645,-18.025 46.13,-20.9125c8.225,1.925 16.695,2.9925 25.55,2.9925c56.595,0 102.725,-39.655 102.725,-89.285c0,-49.63 -46.13,-89.285 -102.725,-89.285zM112,26.565c52.7275,0 94.395,36.505 94.395,80.955c0,44.45 -41.6675,80.955 -94.395,80.955c-9.135,0 -17.745,-0.875 -25.83,-2.9925l-2.59,-0.6825l-1.6975,2.0825c0,0 -12.9325,14.595 -33.5825,18.1125c3.745,-6.755 6.51,-13.055 7.7875,-17.815c1.8025,-6.6325 1.8375,-11.1125 1.8375,-11.1125v-2.2925l-1.925,-1.225c-23.66,-15.05 -38.395,-38.3425 -38.395,-65.03c0,-44.45 41.6675,-80.955 94.395,-80.955zM67.2,98.56c-4.9525,0 -8.96,4.0075 -8.96,8.96c0,4.9525 4.0075,8.96 8.96,8.96c4.9525,0 8.96,-4.0075 8.96,-8.96c0,-4.9525 -4.0075,-8.96 -8.96,-8.96zM112,98.56c-4.9525,0 -8.96,4.0075 -8.96,8.96c0,4.9525 4.0075,8.96 8.96,8.96c4.9525,0 8.96,-4.0075 8.96,-8.96c0,-4.9525 -4.0075,-8.96 -8.96,-8.96zM156.8,98.56c-4.9525,0 -8.96,4.0075 -8.96,8.96c0,4.9525 4.0075,8.96 8.96,8.96c4.9525,0 8.96,-4.0075 8.96,-8.96c0,-4.9525 -4.0075,-8.96 -8.96,-8.96z"></path></g></g></g></svg>

              <span style="margin: 10px;display: block;float: right;">Test Me Here</span>  

            </a>`)
        }
      })
      console.log("insert beore body")
    }, 200);
   
      
    RED.nodes.registerType('hanna-app',{
        category: 'config',
        defaults: {
            appName: {
                value:"",
                required: true
            }, 
            uri: {
                value:"",
            },    
            socket: {
                value:"chat/message",
                required: true
            },       
            image: {
                value:"",
                required: true
            },       
            startMessage: {
                value:""
            },      
            name: {}
        },
        label: function() {
            return (this.name ? this.name : this.appName);
        },
        oneditprepare: function(){
          let prefix = "https://box.tekos.co/@"+(this.uri || 'tekos')+'.';
          let content =  prefix+$("#node-config-input-appName").val()+'/app'
          $("#node-config-input-link").attr('href', content).text(content)

          $("#node-config-input-appName").keyup(function(key){
                 
              $("#node-config-input-link").attr('href', prefix+$(this).val()).text(prefix+$(this).val()+'/app')
          });
        
        }
        
    });

    
</script>

<!-- ***************** SERVER CONFIG *********************** -->
<script type="text/x-red" data-template-name="deepstream-server">
    <div class="form-row node-input-server">
        <label for="node-config-input-server"><i class="fa fa-bookmark"></i> Server</label>
        <input class="input-append-left" type="text" id="node-config-input-server" placeholder="localhost" style="width: 45%;" >
        <label for="node-config-input-port" style="margin-left: 10px; width: 35px; "> Port</label>
        <input type="text" id="node-config-input-port" placeholder="Port" style="width:45px">   
    </div>
  <div class="form-row">
        <label for="node-config-input-subscriptionTimeout"> Subscription Timeout</label>
        <input type="text" id="node-config-input-subscriptionTimeout" placeholder="Timeout">
    </div>
  <div class="form-row">
        <label for="node-config-input-rpcAckTimeout"> RPC Ack Timeout</label>
        <input type="text" id="node-config-input-rpcAckTimeout" placeholder="Timeout">
    </div>
  <div class="form-row">
        <label for="node-config-input-rpcResponseTimeout"> RPC Response Timeout</label>
        <input type="text" id="node-config-input-rpcResponseTimeout" placeholder="Timeout">
    </div>
    <div class="form-row">
        <label for="node-config-input-user"><i class="fa fa-user"></i>Username</label>
        <input type="text" id="node-config-input-user">
    </div>
    <div class="form-row">
        <label for="node-config-input-pass"><i class="fa fa-lock"></i>Password</label>
        <input type="password" id="node-config-input-password">
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
</script>

<script type="text/javascript">
    RED.nodes.registerType('deepstream-server',{
        category: 'config',
        color:"#81DAF5",
        defaults: {
            server: {
        required:true
      },
            port: {
        value:6020,
        required:true,
        validate:RED.validators.number()
      },       
      subscriptionTimeout: {
        value : 500,
        validate: RED.validators.number()
      },
      rpcAckTimeout: {
        value : 6000,
        validate: RED.validators.number()
      },
      rpcResponseTimeout: {
        value : 10000,
        validate: RED.validators.number()
      },
            name: {}
        },
        credentials: {
            user: {type:"text"},
            password: {type: "password"}
        },
        label: function() {
            return (this.name ? this.name : this.server+":"+this.port);
        }
    });
</script>
<style type="text/css">
  editor-tray-body 
  .dialog-form, 
  .editor-tray-body #dialog-form, 
  .editor-tray-body #node-config-dialog-edit-form {
    /* margin: 20px; */
    /* height: calc(100% - 40px); */
}
</style>