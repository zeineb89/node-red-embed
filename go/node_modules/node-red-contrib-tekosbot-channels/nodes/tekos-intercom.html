<!-- ***************** Intercom *********************** -->

<script type="text/x-red" data-help-name="Intercom">
    <h6>Intercom</h6>
    <p>Reply to an end user convesartion</p>
    <p>The properties can be passed in msg :</p>
    <pre>
        <code>
            msg.payload.userId: "536e564f316c83104c000020";
            msg.payload.content: "Thanks again :)";
            msg.conversationId: "20930702018";
            
        </code>
    </pre>

   <p>For more information, visit this link : <a href="https://developers.intercom.com/intercom-api-reference/reference#replying-to-a-conversation"> Intercom docs</a></p>
</script>

<script type="text/javascript">
    
    RED.nodes.registerType('Intercom',{
        category: 'Channels',
        color:"#009f9d",
        defaults: {
            name: {value: ""},
            userId: {value: ""},
            body: {value: ""},
            messageType: {value: "comment"},
            conversationId : {value: ""},
            formValue:{value:{}},
            payload: {value: ''},
            topic: {value: ''},
            intercom: {type:"intercom-config",required:true},
        },
        inputs:1,
        outputs:0,
        icon: "chatbot-waiting.png",
        align: 'left',
        paletteLabel: 'Intercom Out',
        label: function() {
            return this.name||"Intercom Out";
        },
        labelStyle: function() {
            return (this.name)?"node_label_italic":"";
        }
        ,
        oneditprepare: function oneditprepare() {
          $('#node-input-messageType').on('change', ()=>{
          if(($('#node-input-messageType').val() !== 'comment') && ($('#node-input-messageType').val() !== 'note')){
            $("#body-input").hide()
          }else{
            $("#body-input").show()

          }
          });
       
        }
    });
   
</script>

<script type="text/x-red" data-template-name="Intercom">
    <div class="form-row">
        <label for="node-input-intercom" style="width: 110px;"><i class="fa fa-bookmark"></i> App Intercom </label>
        <input type="text" id="node-input-intercom">
    </div>
    <div class="form-row">
        <label for="node-input-userId" style="width: 110px;"><i class="fa fa-bookmark"></i> Id user </label>
        <input type="text" id="node-input-userId">
    </div>
   <!--  <div class="form-row">
        <label for="node-input-conversationId" style="width: 110px;"><i class="fa fa-bookmark"></i> Conversation Id </label>
        <input type="text" id="node-input-conversationId">
    </div> -->
  <!--   <div id="body-input">
        <div class="form-row">
            <label for="node-input-body"><i class="icon-envelope"></i> Body </label>
            <textarea id="node-input-body" placeholder="Body" /> 
        </div>
    </div>
    <div class="form-row">
      <label for="node-input-messageType" style="width: 110px;"><i class="icon-tag"></i> Type Message </label>
      <select id="node-input-messageType">
        <option value="comment">Comment</option>
        <option value="assignment">Assignment</option>
        <option value="open">Open</option>
        <option value="close">Close</option>
        <option value="note">Note</option>
      </select>
    </div> -->

    <div class="form-row">
        <label for="node-input-name" style="width: 110px;"><i class="fa fa-tag"></i> Name </label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>
<!-- ***************** HUBSPOT APP CONFIG *********************** -->
<script type="text/x-red" data-template-name="intercom-config">
    <div class="form-row">
        <label for="node-config-input-authToken"><i class="fa fa-tag"></i>Auth TOKEN</label>
        <input type="text" id="node-config-input-authToken" placeholder="AUTH TOKEN" />
    </div>
    <div class="form-row">
        <label for="node-config-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-config-input-name" placeholder="Name">
    </div>
  
</script>

<script type="text/javascript">
    RED.nodes.registerType('intercom-config',{
        category: 'config',
        defaults: {
            authToken: {
                value:"",
                required: true
            },       
            name: {}
        },
        label: function() {
            return this.name ;
        }
        
    });
</script>
